
## 🎯 Objetivos

- Verificar el uso de disco y espacio libre en el sistema.
- Utilizar herramientas para comprobar y reparar sistemas de archivos.
- Optimizar y ajustar parámetros del sistema de archivos ext.
- Trabajar con `ext2/3/4` y `XFS`.

---

## 1. 📘 Introducción

Los sistemas de archivos modernos (ext3, ext4, xfs) usan _journaling_ para registrar operaciones antes de aplicarlas. Esto protege contra corrupción, pero **aún se requiere supervisión y reparación periódica**LPI-Learning-Material-1….

---
## 2. 📊 Comprobación del uso del disco

### Comando `du` (disk usage)

Muestra cuánto espacio ocupa un directorio y sus contenidos:

```bash
du -h
```

Parámetros útiles:

- `-a`: incluye archivos
- `-h`: salida legible
- `-S`: excluye subdirectorios
- `-d N`: limita profundidad

Ejemplo:

```bash
du -ah --exclude="*.bin"
```

---
## 3. 📈 Comprobación de espacio libre

### Comando `df`

Muestra espacio libre a nivel de sistema de archivos:

```bash
df -h
```

Filtrar por tipo:

```bash
df -t ext4
```

Mostrar inodos:

```bash
df --output=source,fstype,itotal,iused,ipcent
```

---

## 4. 🧰 Mantenimiento de sistemas de archivos

### Comando `fsck`

Herramienta para comprobar y reparar:

```bash
fsck /dev/sdX
```

Parámetros útiles:

- `-A`: todos los de `/etc/fstab`
- `-C`: barra de progreso
- `-N`: modo simulación
- `-R`: excluye raíz
- `-V`: modo detallado
- `-t tipo`: especifica tipo (vfat, ext4…)

### Comando `e2fsck`

Específico para ext2/3/4:

```bash
e2fsck -p /dev/sda1   # automático
e2fsck -y /dev/sda1   # todo sí
e2fsck -n /dev/sda1   # solo lectura
```

> ⚠️ **No usar `fsck` sobre sistemas montados**LPI-Learning-Material-1…

---

## 5. 🧪 Ajustes con `tune2fs`

Permite ver o cambiar parámetros de ext:

```bash
tune2fs -l /dev/sda1
tune2fs -l /dev/sda1
```

### Ejemplos:

- Convertir ext2 a ext3 y aplicar cambios:

```bash
tune2fs -j -C 0 -L UserData /dev/sdb1
```

- Cambiar cantidad máxima de montajes antes de chequeo:

```bash
tune2fs -c 10 /dev/sda1
```

---
## 6. 🧪 XFS: Verificación

- Reparación:

```bash
xfs_repair /dev/sdX
```

- Diagnóstico:

```bash
xfs_db /dev/sdX
```

---

## 🧪 Ejercicios Guiados

1. Ver espacio usado por archivos del directorio actual:

```bash
du -S -h -d 0
```

2. Ver info detallada de sistemas ext4:

```bash
df -t ext4 --output=source,target,itotal,iavail,pcent
```

3. Ejecutar reparación automática en `/dev/sdc1`:

```bash
e2fsck -p /dev/sdc1
```

---

## 🎯 Actividad Final Desarrollada

1. **Situación**: El sistema `/dev/sdb1` (ext2) está lento y sin mantenimiento.
    a. Verificar su integridad automáticamente:
    
```bash
e2fsck -p /dev/sdb1
```
    
    b. Convertirlo a ext3, reiniciar contadores y renombrarlo a `BackupData`:
    
```bash
tune2fs -j -C 0 -L BackupData /dev/sdb1
```
    
    c. Asegurar chequeo cada 30 días:
    
```bash
tune2fs -i 30d /dev/sdb1
```
    
2. **Sistema XFS `/dev/sdc1`**:
    a. Verificar sin modificar:
    
```bash
xfs_db /dev/sdc1
```
    
    b. Reparar:
    
```bash
xfs_repair /dev/sdc1
```

---

## 📚 Comandos clave

- `du`, `df`
- `fsck`, `e2fsck`
- `tune2fs`
- `xfs_repair`, `xfs_db`