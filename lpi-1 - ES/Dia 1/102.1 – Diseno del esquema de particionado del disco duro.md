
## 🎯 Objetivos de la lección

- Comprender la relación entre discos, particiones, sistemas de archivos y volúmenes.
- Diseñar particiones adaptadas a diferentes usos del sistema.
- Conocer el uso de la partición `/boot`, la partición de intercambio y LVM.
- Aplicar comandos y buenas prácticas en el diseño de particionado.

---

## 📚 Contenido Ampliado

### 🔹 Introducción

Antes de poder usar un disco, este debe ser **particionado**. Una partición es un subconjunto lógico del disco físico. A su vez, dentro de cada partición se implementa un **sistema de archivos**.

---

### 🔹 Puntos de Montaje

- Linux accede a discos y particiones mediante **puntos de montaje**.
- Ejemplo clásico: montar la partición de usuario en `/home`.
- Directorios comunes para montar:
    - `/` → raíz
    - `/boot` → archivos del cargador de arranque
    - `/home`, `/var`, `/tmp` → recomendados por separado según el uso.

**Comando útil**:

```bash
cat /etc/fstab
```

Para ver los sistemas de archivos montados automáticamente.

---

### 🔹 Separación de Particiones

**Ventajas**
- Mejora la seguridad y rendimiento.
- Facilita la recuperación ante errores.
- Previene que un directorio llene todo el disco.

**Ejemplo**:

- Servidores con `/var` separado (almacena logs, datos variables).
- Estaciones de trabajo con `/home` separado para datos de usuario.

---

### 🔹 Partición de Intercambio (Swap)

- Funciona como extensión de la memoria RAM.
- No se monta como otros sistemas de archivos.
- Se puede implementar como:
    - Partición swap.
    - Archivo de intercambio.

**Tamaño recomendado**:

- < 2 GB RAM → 2x RAM.
- 2-8 GB RAM → igual a RAM.
- > 8 GB → 4 GB mínimo o uso específicoLPI-Learning-Material-1….

**Comandos**:

```bash
# Crear un archivo de 1 GB para swap
dd if=/dev/zero of=/swapfile bs=1M count=1024
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile
```

---

### 🔹 LVM (Logical Volume Manager)

- Permite crear volúmenes lógicos sobre discos físicos.
- Flexible para redimensionar volúmenes sin necesidad de reiniciar.
- Se puede usar con múltiples discos físicos.

**Componentes**:

- PV (Physical Volume): disco o partición.
- VG (Volume Group): conjunto de PV.
- LV (Logical Volume): equivalente a partición lógica.

**Ejemplo de flujo**:

```bash
pvcreate /dev/sdb1
vgcreate vgdatos /dev/sdb1
lvcreate -L 10G -n volumen1 vgdatos
mkfs.ext4 /dev/vgdatos/volumen1
mount /dev/vgdatos/volumen1 /mnt
```

---

## 🧪 Ejercicios prácticos

### ✅ Ejercicio 1: Verificar puntos de montaje

```bash
lsblk
mount | column -t
```

### ✅ Ejercicio 2: Crear archivo de swap de 512 MB

```bash
dd if=/dev/zero of=/swapfile2 bs=1M count=512
chmod 600 /swapfile2
mkswap /swapfile2
swapon /swapfile2
```
### ✅ Ejercicio 3: Usar LVM

```bash
# Crear volumen lógico
pvcreate /dev/sdc1
vgcreate vg01 /dev/sdc1
lvcreate -L 2G -n datos vg01
mkfs.ext4 /dev/vg01/datos
mount /dev/vg01/datos /mnt
```

---

## 📝 Actividad Final

Pida al alumnado diseñar un esquema de particionado para:

1. Un servidor web.
2. Un escritorio personal.
3. Una máquina virtual con poco espacio.

Cada diseño debe especificar:

- Directorios separados.
- Uso o no de swap.
- Uso de LVM.

---

### 🖥️ 1. **Servidor Web**

#### Esquema:

- `/` – 20 GB
- `/boot` – 1 GB
- `/var` – 40 GB (con LVM)
- `/home` – 10 GB (con LVM)
- `swap` – 4 GB

#### Comandos:

```bash
# Crear particiones
fdisk /dev/sdb  # Crear /boot y una grande para LVM

# Supongamos: /dev/sdb1 = /boot y /dev/sdb2 = LVM

# Formatear /boot
mkfs.ext4 /dev/sdb1
mount /dev/sdb1 /boot

# Configurar LVM
pvcreate /dev/sdb2
vgcreate vgweb /dev/sdb2

# Crear volúmenes lógicos
lvcreate -L 40G -n var vgweb
lvcreate -L 10G -n home vgweb
lvcreate -L 4G -n swap vgweb

# Formatear volúmenes
mkfs.ext4 /dev/vgweb/var
mkfs.ext4 /dev/vgweb/home
mkswap /dev/vgweb/swap
swapon /dev/vgweb/swap

# Montar puntos de montaje
mount /dev/vgweb/var /var
mount /dev/vgweb/home /home
```

---

### 💻 2. **Estación de Trabajo**

#### Esquema:

- `/` – 30 GB
- `/boot` – 1 GB
- `/home` – 100 GB (con LVM)
- `swap` – 8 GB (RAM = 8 GB)

#### Comandos:

```bash
fdisk /dev/sdc  # Crear /boot y partición para LVM

# /dev/sdc1 = /boot, /dev/sdc2 = LVM

mkfs.ext4 /dev/sdc1
mount /dev/sdc1 /boot

# Configurar LVM
pvcreate /dev/sdc2
vgcreate vgdesk /dev/sdc2

lvcreate -L 100G -n home vgdesk
lvcreate -L 8G -n swap vgdesk

mkfs.ext4 /dev/vgdesk/home
mkswap /dev/vgdesk/swap
swapon /dev/vgdesk/swap

mount /dev/vgdesk/home /home
```

---

### 🧪 3. **Máquina Virtual de Laboratorio**

#### Esquema:

- `/` – 20 GB
- `/boot` – 500 MB
- `swap` – 1 GB
- Sin LVM

#### Comandos:

```bash
fdisk /dev/sdd  # Crear 3 particiones: /boot, /, swap

# /dev/sdd1 = /boot, /dev/sdd2 = /, /dev/sdd3 = swap

mkfs.ext4 /dev/sdd1
mkfs.ext4 /dev/sdd2
mkswap /dev/sdd3
swapon /dev/sdd3

mount /dev/sdd1 /boot
mount /dev/sdd2 /
```