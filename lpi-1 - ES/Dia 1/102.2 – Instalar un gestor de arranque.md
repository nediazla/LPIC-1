
## 🎯 Objetivos

- Entender qué es un gestor de arranque y cómo funciona.
- Conocer las diferencias entre GRUB Legacy y GRUB 2.
- Saber cómo ubicar, configurar e instalar GRUB    
- Aprender a modificar parámetros y entradas del menú de arranque.

---

## 📚 Contenido

### 🔹 1. Introducción

Al encender un sistema, lo primero que se ejecuta es el **cargador de arranque**. Este se encarga de cargar el **kernel** del sistema operativo en memoria y transferirle el control.

GRUB es el gestor de arranque más común en Linux. Puede arrancar diferentes sistemas operativos y manejar múltiples configuraciones de kernel.

---

### 🔹 2. GRUB Legacy vs GRUB 2

#### GRUB Legacy

- Versión antigua (última v0.97 en 2005).
- Configurado mediante `/boot/grub/menu.lst`.
- Comandos sencillos: `title`, `root`, `kernel`.

Ejemplo de entrada:

```bash
title Linux
root (hd0,0)
kernel /vmlinuz root=/dev/hda1
```

#### GRUB 2

- Reescrito desde cero.
- Archivo de configuración: `/boot/grub/grub.cfg`.
- Configuración mediante `/etc/default/grub` y `/etc/grub.d/`.
- Comando para regenerar el menú:

```bash
update-grub   # o
grub-mkconfig -o /boot/grub/grub.cfg
```

---

### 🔹 3. ¿Dónde se instala el gestor?

- En sistemas MBR: GRUB se instala en el **MBR** (primer sector de 512 bytes).
- En sistemas UEFI: el firmware carga GRUB desde la partición **ESP** (`/boot/efi`).
- El núcleo y `initrd` suelen estar en `/boot`.

Comando para instalar GRUB:

```bash
grub-install /dev/sda
```

Con partición montada:

```bash
mount /dev/sda1 /mnt
grub-install --boot-directory=/mnt/boot /dev/sda
```

---

### 🔹 4. La Partición /boot

- Contiene el kernel, initrd y archivos del gestor de arranque.
- Tamaño recomendado: **300 MB**.
- Puede estar separada para compatibilidad o por seguridad.

---

## 🧪 Ejercicios Prácticos

### ✅ Ver ubicación del cargador

```bash
ls -l /boot
fdisk -l
```

### ✅ Montar partición y reinstalar GRUB

```bash
mkdir /mnt/tmp
mount /dev/sda1 /mnt/tmp
grub-install --boot-directory=/mnt/tmp/boot /dev/sda
```

### ✅ Modificar GRUB 2

```bash
nano /etc/default/grub
update-grub
```

---

## 📝 Actividad Final

Crear una entrada personalizada para arrancar desde una imagen ISO ubicada en `/boot`.

1. Copiar una ISO al directorio `/boot/iso/ubuntu.iso`.
2. Editar el archivo `/etc/grub.d/40_custom`:

```bash
menuentry "Ubuntu Live ISO" {
    set isofile="/boot/iso/ubuntu.iso"
    loopback loop (hd0,1)$isofile
    linux (loop)/casper/vmlinuz boot=casper iso-scan/filename=$isofile noeject noprompt splash --
    initrd (loop)/casper/initrd
}
```

3. Actualizar GRUB:

```bash
update-grub
```
