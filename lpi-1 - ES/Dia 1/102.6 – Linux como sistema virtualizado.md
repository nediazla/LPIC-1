
## 🎯 Objetivos

- Comprender el concepto general de virtualización y contenedores.
- Diferenciar tipos de máquinas virtuales.
- Configurar plantillas de VMs y su implementación en la nube.
- Comprender el uso de herramientas como `cloud-init`, `virt-manager` y `dbus-uuidgen`.

---

## 📚 Contenido

### 🔹 1. Introducción a la Virtualización

- Permite ejecutar múltiples sistemas operativos en un mismo hardware físico.
- Se logra mediante un **hipervisor**, que asigxnona recursos a las **máquinas virtuales (guests)**.

---

### 🔹 2. Hipervisores comunes en Linux

- **Xen**: Tipo 1 (bare metal).
- **KVM**: Integrado en el kernel de Linux (Tipo 1 o 2).
- **VirtualBox**: Tipo 2, ejecutado sobre un SO.
- **QEMU**: Emulación + virtualización, usado por libvirt.

---

### 🔹 3. Tipos de Máquinas Virtuales

| Tipo              | Descripción                                                                    |
| ----------------- | ------------------------------------------------------------------------------ |
| Fully Virtualized | No requiere cambios en el SO. Requiere CPU con VT-x o AMD-V.                   |
| Paravirtualized   | Requiere un kernel modificado y drivers invitados. Mejor rendimiento.          |
| Hybrid            | Combina ambos, usando drivers paravirtualizados sobre sistemas no modificados. |

---

### 🔹 4. Plantillas de Máquinas Virtuales

- Una plantilla es una VM base lista para clonar y reutilizar.
- Requiere cambiar nombre, MAC, y especialmente la **D-Bus Machine ID**:

```bash
sudo rm -f /etc/machine-id
sudo dbus-uuidgen --ensure=/etc/machine-id
```

Verificar ID:

```bash
dbus-uuidgen --get
```

---

### 🔹 5. Implementación en la nube (IaaS)

Componentes clave:

- **Instancias de computación**: VMs activas que consumen CPU y RAM.
- **Bloques de almacenamiento**: Discos virtuales para cada VM.
- **Redes virtuales**: Subredes, DNS, NAT, VPN.
- **Acceso remoto**: SSH con claves públicas.

```bash
ssh-keygen
ssh-copy-id usuario@host
```

---

### 🔹 6. cloud-init

- Utilidad para automatizar la configuración inicial de una VM.
- Usa archivos `cloud-config` (YAML):

```yaml
#cloud-config
timezone: America/Madrid
hostname: servidor-web
packages:
  - nginx
```

---

### 🔹 7. Contenedores

- Entorno aislado que ejecuta solo lo necesario para una aplicación.
- Más livianos que VMs.
- Tecnologías: **Docker**, **LXC**, **LXD**, **systemd-nspawn**, **OpenShift**.
- Usan **cgroups** y **namespaces**.

---

## 🧪 Ejercicios Guiados

1. ¿Tu CPU soporta virtualización?

```bash
grep --color -E "vmx|svm" /proc/cpuinfo
```

2. Ver ID de máquina D-Bus:

```bash
dbus-uuidgen --get
```

3. Configurar una nueva máquina con Virt-Manager:

- Instala `virt-manager`
- Usa una imagen ISO para crear una nueva VM gráfica.

---

## 📝 Actividad Final

1. Crear una plantilla de VM base con Debian.
2. Clonarla y cambiar:
    - Hostname.
    - MAC address (automático).
    - D-Bus ID:

```bash
sudo rm -f /etc/machine-id
sudo dbus-uuidgen --ensure=/etc/machine-id
```

1. Usar `cloud-init` para desplegar la VM clonada con un hostname y paquetes definidos.