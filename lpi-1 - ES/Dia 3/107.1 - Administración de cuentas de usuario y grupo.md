
## Objetivos

- Agregar, modificar y eliminar cuentas de usuario.
- Administrar información de contraseñas y envejecimiento de cuentas.
- Administrar archivos relacionados: `/etc/passwd`, `/etc/group`, `/etc/shadow`, `/etc/gshadow`.
- Aplicar comandos para controlar expiración, bloqueo y configuración de cuentas.

---
## 1. Agregando cuentas de usuario


```bash
useradd michael
passwd michael
```

Opciones útiles:

- `-c "Comentario"` → Información adicional (nombre completo)
- `-d /ruta/home` → Directorio de inicio personalizado.
- `-e YYYY-MM-DD` → Fecha de expiración.
- `-g grupo` → Grupo principal.
- `-G grupo1,grupo2` → Grupos secundarios.
- `-m` → Crea el directorio home.
- `-s /bin/bash` → Shell de inicio.

Verificación:

```bash
id michael
groups michael
```

---
## 2. Modificación y eliminación de cuentas

Modificar usuario:

```bash
usermod -l nuevo_usuario antiguo_usuario
usermod -s /bin/sh usuario
usermod -d /nuevo/home -m usuario
```

Eliminar usuario:

```bash
userdel usuario
userdel -r usuario  # Elimina su home
```

---
## 3. Directorio skel y archivo login.defs

- `/etc/skel/`: archivos iniciales del home.
- `/etc/login.defs`: valores por defecto para UID, GID, directorios, contraseñas.

Parámetros útiles:

- `CREATE_HOME`, `USERGROUPS_ENAB`
- `PASS_MAX_DAYS`, `PASS_MIN_DAYS`, `PASS_WARN_AGE`

---
## 4. Contraseñas y caducidad

Cambiar contraseña:

```bash
passwd usuario
```

Control con `passwd`:

```bash
passwd -l usuario    # Bloquea
passwd -u usuario    # Desbloquea
passwd -e usuario    # Expira inmediata
passwd -n 1 usuario  # Mínimo 1 día
passwd -x 30 usuario # Máximo 30 días
passwd -w 7 usuario  # Aviso 7 días
passwd -i 5 usuario  # Inactivo 5 días tras exp.
```

Control con `chage`:

```bash
chage -l usuario                # Información
chage -d 0 usuario              # Fuerza cambio
chage -M 365 usuario            # Máximo 1 año
chage -m 1 usuario              # Mínimo 1 día
chage -W 7 usuario              # Aviso
chage -E 2025-12-31 usuario     # Expira cuenta
```

---
## 5. Archivos relacionados

- `/etc/passwd` → info básica: nombre, UID, GID, home, shell.
- `/etc/group` → info grupos.
- `/etc/shadow` → contraseñas cifradas, expiración
- `/etc/gshadow` → contraseñas de grupo.

Visualizar:

```bash
ls -l /etc/passwd /etc/shadow /etc/group /etc/gshadow
```

---
## Ejercicios Guiados

### 1. Crear usuario y establecer contraseña

```bash
useradd -m juan
passwd juan
```

### 2. Verificar configuración

```bash
id juan
groups juan
```

### 3. Modificar shell y expiración

```bash
usermod -s /bin/sh juan
chage -E 2025-12-31 juan
```
### 4. Bloquear y desbloquear usuario

```bash
passwd -l juan
passwd -u juan
```

---
## Ejercicios Exploratorios

1. Crear grupos:

```bash
groupadd administrators
groupadd developers
```

2. Crear usuario `kevin` con múltiples grupos:

```bash
useradd -G administrators,developers kevin
```

3. Modificar y consultar grupos:

```bash
groupmod -n web-designers designers
gpasswd -M emma,dave,frank web-designers
gpasswd -A root web-designers
```

4. Comprobar grupo primario y secundarios:

```bash
id kevin
groups kevin
```

5. Establecer contraseña y caducidad:

```bash
passwd kevin
chage -E 2022-12-31 kevin
```

6. Crear y eliminar usuarios:

```bash
useradd -u 1050 -g administrators -G developers,web-designers emma
usermod -s /bin/sh emma
userdel -r emma
userdel -r kevin
groupdel administrators
groupdel developers
groupdel web-designers
```

---